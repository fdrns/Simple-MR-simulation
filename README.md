# Simple-MR-simulation
Illustration of the problem of pleiotropy between two traits during a Mendelian Randomisation study

In R we simulated two correlated variables x1* and x2* with a Pearson correlation of 0.5 in a virtual sample of 10,000 individuals.  For each variable we also simulated a gene score s1 and s2.  The two genes scores were also correlated with a Pearson correlation of r.  The variables x1 and x2, the simulated metabolites, were the sum of x1* and x2* with s1 and s2 respectively.  The continuous risk factor for which we are trying to find evidence of a causal effect with the simulated metabolites was generated using x1, x2 and a random error term.  We tested two models: 1) the full model including both x1 and x2 as y=x1+x2 and 2) a two-step MR model using the z1 as an instrumental variable for x1 and ignoring x2 and z2.  We compared the beta coefficients of the two models for the effect of x1 on y and calculated the percentage difference between them.  
